# EthHasher

This repo contains the code for the 'Automated labeling of unknown contracts in Ethereum' paper by R Norvill et al.

It contains the scaper used to acquire the data, the code to process the data, the dataset used for experimentation, and the code for contract clustering.

## Requirements
The project makes use of the following libraries:
### Native
time

json

re

### 3rd Party
requests - http://docs.python-requests.org/en/master/ -- http://docs.python-requests.org/en/master/user/intro/#requests-license

bs4 - https://www.crummy.com/software/BeautifulSoup/ -- https://opensource.org/licenses/MIT

ssdeep - https://pypi.python.org/pypi/ssdeep -- https://opensource.org/licenses/lgpl-3.0.html

numpy - http://www.numpy.org/ -- http://www.numpy.org/license.html#license

sklearn - http://scikit-learn.org/stable

distance - https://pypi.python.org/pypi/Distance/

matplotlib - http://matplotlib.org/ -- http://matplotlib.org/users/license.html

## Setup
This is a Python 2.7 project, please ensure you are running the correct version of Python.

The 3rd party libraries listed above will need to be installed. This can be done through the use of pip (https://pypi.python.org/pypi/pip2/0.0.1.dev1).

requests - `pip install requests`

bs4 - `pip install beautifulsoup4`

ssdeep - `pip install ssdeep`

numpy & matplotlib - `pip install numpy scipy matplotlib ipython jupyter pandas sympy nose` (This might be overkill, feel free to be more selective with installing libraries here)

sklearn - `pip install sklearn`

distance - `pip install distance`

N.B: If Python 3.x is the default on your system you may need to use `pip2` in place of `pip` to install the correct version.

## Usage
The file EthHasher.py provides all the necessary functions for acquiring addresses and bytecode of verified contracts in the class `contracts`.

The class `read_write` contains functions for writing all necessary information to file and retrieving it for use.

The class `machine_learning` contains functions for carrying out affinity propagation clustering and associated operations.

Pre-generated versions of all required files that result from acquiring contracts and carrying out affinity propagation are provided.
The file tester.py is used for running the various functions in EthHasher.py.

## Files

address_list.txt - Addresses for full verified contracts list (at time of creation)

bytecode_list - Full bytecode list provided by etherchain.org API

hash_list.txt - Full list of hashes of bytecode

cluster.txt - Ouput of affinity propagation, contains each exemplar and all of the contracts in it's group as hashes

# Cleaned files

version of all three of the above files with records where no bytecode was returned from etherchain.org.
These files are generated by removing records containing the hash of the string 'x0' which is returned when no bytecode was given by the API.

# Backup files

Older version of the files, the backup 'cluster.txt' contains more clusters due to the affinity propagation having been run with a lower maximum number of iterations.
